<h4 mat-dialog-title>Stowrzenie meczu</h4>
<mat-dialog-content>
  <mat-horizontal-stepper [linear]="false" #stepper>

    <mat-step [stepControl]="basicData">
      <form [formGroup]="basicData" class="pt-2">
        <ng-template matStepLabel>Krok 1/3</ng-template>
        <mat-form-field class="col-md-6">
          <mat-label>Nazwa drużyny</mat-label>
          <input matInput placeholder="Nazwa drużyny" formControlName="teamName" required>
        </mat-form-field>
        <mat-form-field class="col-md-6">
          <mat-label>Data meczu</mat-label>
          <input matInput [matDatepicker]="matchDay" placeholder="Data meczu" formControlName="matchDay"
              (dateChange)="dateChanged($event)"   required>
          <mat-datepicker-toggle matSuffix [for]="matchDay"></mat-datepicker-toggle>
          <mat-datepicker #matchDay ></mat-datepicker>
        </mat-form-field>
        <mat-form-field class="col-md-6">
          <mat-label>Kolor stroju</mat-label>
          <mat-select formControlName="dress">
            <mat-option *ngFor="let dress of dresses" [value]="dress.id">{{dress.color}}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-checkbox class="col-md-6" formControlName="isAway">Mecz wyjazdowy</mat-checkbox>
      </form>
      <div class="pt-2">
        <button mat-button matStepperNext class="float-right ">Następny krok</button>
      </div>
    </mat-step>

    <mat-step>
      <form [formGroup]="playerForm" class="pt-2">
        <ng-template matStepLabel>Krok 2/3</ng-template>
        <div class="row" *ngIf="players">
          <mat-form-field class="col-md-12">
            <input type="text"
                   placeholder="Wybierz zawodnika"
                   matInput
                   formControlName="playerName"
                   #trigger="matAutocompleteTrigger"
                   [matAutocomplete]="auto">
            <mat-autocomplete #auto="matAutocomplete">
              <mat-option #matOption style="cursor: pointer" *ngFor="let player of filteredPlayers" [value]="player.id"
                          (click)="toFirstSquad($event,player,trigger)" (contextmenu)="toReserveSquad($event,player,trigger)">
                {{player.firstName}} {{player.lastName}}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
          <div class="example-container col-md-6">
            <div
              class="example-list"
              cdkDropList
              #firstSquad="cdkDropList"
              [cdkDropListData]="firstSquadPlayers"
              [cdkDropListConnectedTo]="[reserveSquad]"
              (cdkDropListDropped)="drop($event)"
            >
              <div class="example-box" *ngFor="let player of firstSquadPlayers" cdkDrag
                   (cdkDragStarted)="dragIsStart()" (cdkDragReleased)="dragIsStop($event)">
                <mat-form-field appearance="legacy" class="col-md-10">
                  <mat-label>Numer koszulki</mat-label>
                  <input type="number" matInput [value]="player.dressNumber" formControlName="firstSquadPlayerNumber"
                         (focusout)="setPlayerNumber($event,player)">
                  <span matSuffix>{{player.firstName}} {{player.lastName}}</span>
                </mat-form-field>
              </div>

            </div>
          </div>
          <div class="example-container col-md-6">
            <div
              cdkDropList
              class="example-list"
              #reserveSquad="cdkDropList"
              [cdkDropListData]="reserveSquadPlayer"
              [cdkDropListConnectedTo]="[firstSquad]"
              (cdkDropListDropped)="drop($event)"
            >
              <div class="example-box" *ngFor="let player of reserveSquadPlayer" cdkDrag
                   (cdkDragEntered)="dragIsStart()" (cdkDragExited)="dragIsStop($event)">
                <mat-form-field appearance="legacy" class="col-md-12">
                  <mat-label>Numer koszulki</mat-label>
                  <input type="number" matInput [value]="player.dressNumber"
                         formControlName="reservedSquadPlayerNumber">
                  <span matSuffix>{{player.firstName}} {{player.lastName}}</span>
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>

      </form>
      <div class="pt-2">

        <button mat-button matStepperPrevious class="float-left">Poprzedni krok</button>
        <button mat-button matStepperNext class="float-right">Następny krok</button>
      </div>
    </mat-step>

    <mat-step>
      <form [formGroup]="playerFunction" class="pt-2">
        <ng-template matStepLabel>Krok 3/4</ng-template>
        <mat-form-field class="col-md-6" *ngIf="firstSquadPlayers">
          <mat-select
            placeholder="Wybierz bramkarza"
            formControlName="firstSquadGoalKeeper">
            <mat-option style="cursor: pointer" *ngFor="let player of firstSquadPlayers" [value]="player.id">
              {{player.firstName}} {{player.lastName}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field class="col-md-6" *ngIf="firstSquadPlayers">
          <mat-select
            placeholder="Wybierz kapitana"
            formControlName="captain">
            <mat-option style="cursor: pointer" *ngFor="let player of firstSquadPlayers" [value]="player.id">
              {{player.firstName}} {{player.lastName}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field class="col-md-6" *ngIf="reserveSquadPlayer">
          <mat-select
            placeholder="Wybierz rezerwowego bramkarza"
            formControlName="reservedSquadGoalKeeper">
            <mat-option style="cursor: pointer" *ngFor="let player of reserveSquadPlayer" [value]="player.id">
              {{player.firstName}} {{player.lastName}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </form>
      <div class="pt-2">
        <button mat-button matStepperPrevious class="float-left">Poprzedni krok</button>
        <button mat-button matStepperNext class="float-right">Następny krok</button>
      </div>

    </mat-step>
    <mat-step>
      <form [formGroup]="personForm" class="pt-2">
        <ng-template matStepLabel>Krok 3/3</ng-template>
        <mat-form-field class="col-md-6">
          <mat-label>Trener</mat-label>
          <input type="text"
                 placeholder="Wybierz trenera"
                 matInput
                 formControlName="coach"
                 [matAutocomplete]="autoCoach" required>
          <mat-autocomplete #autoCoach="matAutocomplete" [displayWith]="getName">
            <mat-option [value]="null">-</mat-option>
            <mat-option *ngFor="let person of staffPeople"
                        [value]="person">{{person.firstName}} {{person.lastName}}</mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <mat-form-field class="col-md-6">
          <mat-label>Trener II</mat-label>

          <input type="text"
                 placeholder="Wybierz drugiego trenera"
                 matInput
                 formControlName="secondCoach"
                 [matAutocomplete]="autoSecondCoach">
          <mat-autocomplete #autoSecondCoach="matAutocomplete" [displayWith]="getName">
            <mat-option [value]="null">-</mat-option>
            <mat-option *ngFor="let person of staffPeople"
                        [value]="person">{{person.firstName}} {{person.lastName}}</mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <mat-form-field class="col-md-6">
          <mat-label>Masażysta</mat-label>

          <input type="text"
                 placeholder="Wybierz masażystę"
                 matInput
                 formControlName="masseur"
                 [matAutocomplete]="autoMasseur">
          <mat-autocomplete #autoMasseur="matAutocomplete" [displayWith]="getName">
            <mat-option [value]="null">-</mat-option>
            <mat-option *ngFor="let person of staffPeople"
                        [value]="person">{{person.firstName}} {{person.lastName}}</mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <mat-form-field class="col-md-6">
          <mat-label>Opiekun medyczny</mat-label>
          <input type="text"
                 placeholder="Wybierz opiekę medyczną"
                 matInput
                 formControlName="medicalCarer"
                 [matAutocomplete]="autoMedicalCarer" [required]="isAway.value">
          <mat-autocomplete #autoMedicalCarer="matAutocomplete" [displayWith]="getName">
            <mat-option [value]="null">-</mat-option>
            <mat-option *ngFor="let person of staffPeople"
                        [value]="person">{{person.firstName}} {{person.lastName}}</mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <mat-form-field class="col-md-6">
          <mat-label>Kierownik drużyny</mat-label>
          <input type="text"
                 placeholder="Wybierz kierownika drużyny"
                 matInput
                 formControlName="teamManager"
                 [matAutocomplete]="autoTeamManager">
          <mat-autocomplete #autoTeamManager="matAutocomplete" [displayWith]="getName">
            <mat-option [value]="null">-</mat-option>
            <mat-option *ngFor="let person of staffPeople"
                        [value]="person">{{person.firstName}} {{person.lastName}}</mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <div class="w-100"></div>
        <mat-form-field class="col-md-6">
          <mat-label>Dodatkowa osoba</mat-label>
          <input type="text"
                 placeholder="Wybierz osobę dodatkowej funkcji"
                 matInput
                 formControlName="additionalPerson"
                 [matAutocomplete]="autoAdditionalPerson">
          <mat-autocomplete #autoAdditionalPerson="matAutocomplete" [displayWith]="getName">
            <mat-option [value]="null">-</mat-option>
            <mat-option *ngFor="let person of staffPeople"
                        [value]="person">{{person.firstName}} {{person.lastName}}</mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <mat-form-field class="col-md-6">
          <mat-label>Funkcja dodatkowej osoby</mat-label>
          <input matInput placeholder="Dodatkowa funkcja" formControlName="additionalFunction"
          >
        </mat-form-field>
      </form>
      <div class="pt-2">
        <button mat-button (click)="createReport()" color="primary" class="float-left">Generuj pdf</button>
        <button mat-button (click)="saveMatch()" color="primary" class="float-right ">Zapisz mecz i generuj PDF</button>
      </div>
    </mat-step>


  </mat-horizontal-stepper>
</mat-dialog-content>
